####################################
# Media Players
####################################
media_player:
  # Bedroom Fire TV ADB
  - platform: androidtv
    device_class: firetv
    name: Bedroom Fire TV ADB
    host: !secret bedroom_fire_tv
    exclude_unnamed_apps: true
    apps:
      com.amazon.tv.launcher: "Fire TV Home"
      uk.co.bbc.iplayer: "BBC iPlayer"
      com.amazon.firetv.youtube: "YouTube"
      com.channel4.ondemand: "All 4"
      air.ITVMobilePlayer: "ITV Hub"

  # Lounge Fire TV ADB
  - platform: androidtv
    device_class: firetv
    name: Lounge Fire TV ADB
    host: !secret lounge_fire_tv

  # Lounge TV ADB
  - platform: androidtv
    device_class: androidtv
    name: Lounge TV ADB
    host: !secret lounge_tv
    exclude_unnamed_apps: true
    apps:
      com.sony.dtv.hbbtvlauncher: "All 4"
      com.sony.dtv.tvx: "External Source"

  # Bedroom TV
  - platform: universal
    name: Bedroom TV
    children:
      - media_player.bedroom_fire_tv_adb
      - media_player.bedroom_fire_tv
    commands:
      turn_on:
        service: switch.toggle
        target:
          entity_id: switch.bedroom_tv_power
      turn_off:
        service: switch.toggle
        target:
          entity_id: switch.bedroom_tv_power
      volume_up:
        service: switch.toggle
        target:
          entity_id: switch.bedroom_soundbar_volume_up
      volume_down:
        service: switch.toggle
        target:
          entity_id: switch.bedroom_soundbar_volume_down
      volume_mute:
        service: switch.toggle
        data:
          entity_id: switch.bedroom_soundbar_mute
      select_source:
        service: media_player.select_source
        data:
          entity_id: media_player.bedroom_fire_tv_adb
          source: "{{ source }}"
    attributes:
      is_volume_muted: media_player.bedroom_fire_tv_adb|is_volume_muted
      state: media_player.bedroom_fire_tv_adb
      source: media_player.bedroom_fire_tv_adb|source
      source_list: media_player.bedroom_fire_tv_adb|source_list

  # Lounge TV
  - platform: universal
    name: Lounge TV
    children:
      - media_player.lounge_fire_tv_adb
      - media_player.lounge_tv_adb
    commands:
      turn_on:
        service: media_player.turn_on
        data:
          entity_id: media_player.lounge_tv_adb
      turn_off:
        service: media_player.turn_off
        data:
          entity_id: media_player.lounge_tv_adb
      volume_up:
        service: media_player.volume_up
        data:
          entity_id: media_player.lounge_tv_adb
      volume_down:
        service: media_player.volume_down
        data:
          entity_id: media_player.lounge_tv_adb
      volume_mute:
        service: media_player.volume_mute
        data:
          entity_id: media_player.lounge_tv_adb
      select_source:
        service: media_player.select_source
        data:
          entity_id: media_player.lounge_fire_tv_adb
          source: "{{ source }}"
      volume_set:
        service: media_player.volume_set
        data:
          entity_id: media_player.lounge_tv_adb
          volume_level: "{{ volume_level }}"
    attributes:
      state: media_player.lounge_fire_tv_adb
      is_volume_muted: media_player.lounge_tv_adb|is_volume_muted
      source: media_player.lounge_fire_tv_adb|source
      source_list: media_player.lounge_fire_tv_adb|source_list

  # Starrunner
  - platform: universal
    name: Starrunner
    state_template: >
      {% if is_state('binary_sensor.starrunner_online', 'on')  and  is_state_attr('media_player.spotify_seb', 'source', 'STARRUNNER') %}
        {% if is_state('media_player.spotify_seb', 'playing') %}
          playing
        {% else %}
          paused
        {% endif %}
      {% else %}
        idle
      {% endif %}
    children:
      - media_player.spotify_seb
    commands:
      media_play:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_play_pause
      media_pause:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_play_pause
      media_next_track:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_next
      media_previous_track:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_previous
      volume_up:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_volume_up
      volume_down:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_volume_down
      volume_mute:
        service: switch.toggle
        target:
          entity_id: switch.starrunner_media_mute
